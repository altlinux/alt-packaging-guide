[[introduction]]
== Вступление

Руководство по сборке RPM пакетов:

== Предисловие

Уважаемый читатель, данное руководство по сборке пакетов предназначено для начинающих мейнтейнеров. Призываю вас внимательно читать текст и не лениться переходить по ссылкам, встречающимся в тексте, поскольку они более подробно излагают затрагиваемые в данной документации темы.

ifdef::community[]
[[pdf-version]]
== PDF Версия

Вы также можете скачать
https://alt-packaging-guide.github.io/alt-packaging-guide.pdf[PDF версию
данного документа].
endif::community[]

== Введение в распространение программ в системах Unix

В дистрибутивах семейства Unix программы распространяются несколькими способами:

* посредством программных пакетов
* в виде архивов, содержащих исполняемые файлы
* распространение исходных текстов программ

Множество  программ  распространяются в виде исходного кода, например, публикуются на github. Достоинством данного способа является возможность компиляции кода практически под любую ОС. Однако,  сборка ПО под некоторую ОС может оказаться трудной и неподъемной задачей для выполнения среднестатистическим пользователем. Поэтому сборка  ПО  из  исходных  текстов  чревата  потерями времени,  машинно-специфичными  сборками,  потерей  стандартизации,  а следовательно и контроля над ПО. 

*Решение проблемы — использование специального ПО и политики управления пакетами* с целью стандартизации управления жизненным циклом ПО. Одним из решений для управления ПО является использование формата RPM, а также одноименного менеджера пакетов.


== Пакетный менеджер RPM

image::introduction_package.png[Abstract programm package]

Прежде всего пакет -- это единица управления ПО. Это просто файл, содержащий другие файлы и информацию о них, необходимую системе. В частности, пакет RPM состоит из архива cpio , содержащего файлы, и заголовка RPM, содержащего метаданные о пакете. Менеджер rpm-пакетов использует эти метаданные для определения зависимостей, места установки файлов и другой информации.

Таким образом rpm-пакет состоит из:

* исполняемых и конфигурационных файлов
* предустановочных действий
* постустановочных действий
* различной  служебной информации

Соответственно, пакет это несколько больше, чем просто архив файлов. При установке пакета, пакетный менеджер записывает информацию о нем в свою базу данных, что и позволяет в дальнейшем удалять пакет, просматривать информацию о нем и т.д.

База данных RPM находится в каталоге /var/lib/rpm. Она состоит из одиночной базы данных (Packages), в которой хранится вся информация о пакетах, и множества маленьких баз (__db.001, __db.002 и т. д.), которые служат для индексации и содержат в себе сведения о том, какие файлы менялись и создавались при установке и удалении пакетов.

*Таким образом распространение программ при помощи RPM-технологии обеспечивает:*

* унификацию работы с разными пакетами (в частности, нет нужды помнить, куда какая-либо программа положила при инсталляции свои файлы)
* отслеживание зависимостей между пакетами выполняется автоматически (не надо помнить, что программа такая-то требует некоей библиотеки с версией не ниже какой-то)
* непротиворечивость между разными пакетами – в частности, корректно "разводится" ситуация, когда несколько пакетов содержат один и тот же файл (например, в /etc/)

[[document-conventions]]
== Структура документации

Перед тем, как приступить к сборке, нужно создать структуру каталогов, необходимую RPM, находящуюся в Вашем «домашнем» каталоге:

* Отображение файловой структуры будет представлено следующим образом:

+

[source,bash]
----
$ tree ~/RPM/
/home/user/RPM/
|-- BUILD
|-- BUILDROOT
|-- RPMS
|   |-- i586
|   |-- x86_64
|   `-- noarch
|-- SOURCES
|-- SPECS
`-- SRPMS

----

* В дальнейшем вывод команд будет продемонстрирован следующим образом:



+

[source,txt]
----
Name:           bello
Version:
Release:        alt1
Summary:

----


* Темы, представляющие интерес, или словарные термины упоминаются либо как ссылки на соответствующую документацию или веб-сайт выделены **жирным** шрифтом, либо __курсивом__. Первые упоминания некоторых терминов ссылаются на соответствующую документацию.

* Названия утилит, команд и других элементов, обычно встречающихся в коде, написаны ``моноширинным`` шрифтом.

